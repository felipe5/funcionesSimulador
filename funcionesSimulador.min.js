function crearTabla(datos){var bodyString='';$.each(datos,function(index,datillos){bodyString+=('<tr><td>'+datillos+'</td><td>')});$('.randomsTable tbody').html(bodyString)}
function seed(){var timestamp=new Date().getMilliseconds();console.log(timestamp);return timestamp}
function repetidos(arr){var a=[],b=[],prev;arr.sort();for(var i=0;i<arr.length;i++){if(arr[i]!==prev){a.push(arr[i]);b.push(1)}else{b[b.length-1]++}
prev=arr[i]}
return[a,b]}
function discretizar(randoms){for(var i=0;i<randoms.length;i++){randoms[i]=quantileRank(randoms,randoms[i]);randoms[i]=randoms[i].toFixed(2)};return randoms}
var chart=null;function graficar(eX,eY,tipo,nombreTitulo,disp,labelX,labelY){if(!disp)
disp=!1;if(!tipo)
tipo='bar';if(!nombreTitulo)
nombreTitulo='Repeticiones';if(chart!=null){chart.destroy()}
eX.unshift(0);eY.unshift(0);var ctx=document.getElementById('myChart').getContext('2d');chart=new Chart(ctx,{type:tipo,data:{labels:eX,datasets:[{label:nombreTitulo,backgroundColor:'rgb(255, 99, 132)',borderColor:'rgb(99, 99, 99)',data:eY,}]},options:{scales:{yAxes:[{scaleLabel:{display:disp,labelString:labelY}}],xAxes:[{scaleLabel:{display:disp,labelString:labelX}}],}}})}
var chart2=null;function graficar2(eX,eY,tipo,nombreTitulo,disp,labelX,labelY){if(!disp)
disp=!1;if(!tipo)
tipo='bar';if(!nombreTitulo)
nombreTitulo='Repeticiones';if(chart2!=null){chart2.destroy()}
eX.unshift(0);eY.unshift(0);var ctx=document.getElementById('myChart2').getContext('2d');chart2=new Chart(ctx,{type:tipo,data:{labels:eX,datasets:[{label:nombreTitulo,backgroundColor:'rgb(255, 99, 132)',borderColor:'rgb(99, 99, 99)',data:eY,}]},options:{scales:{yAxes:[{scaleLabel:{display:disp,labelString:labelY}}],xAxes:[{scaleLabel:{display:disp,labelString:labelX}}],}}})}
function cambiarVista(param){if(param==1){document.getElementById('mostrandoDiagrama').style.display='none';document.getElementById('mostrandoCodigo').style.display='inline'}
else{document.getElementById('mostrandoCodigo').style.display='none';document.getElementById('mostrandoDiagrama').style.display='inherit'}}
function createRand(){var limit=document.getElementById('valor_cant').value||1000;var z=seed();var m=document.getElementById('valor_m').value||Math.pow(2,31);var a=document.getElementById('valor_a').value||1103515245;var c=document.getElementById('valor_c').value||12345;var randoms=[limit];console.log(m,a,c,z);randoms[0]=((a*z+c)%m);for(i=1;i<limit;i++){randoms[i]=((a*randoms[i-1]+c)%m)}
for(i=0;i<limit;i++){randoms[i]=randoms[i]/m}
crearTabla(randoms);arrayToHistogram(randoms);for(var i=0;i<randoms.length;i++){randoms[i]=randoms[i].toFixed(2)};var ejes=repetidos(randoms);graficar(ejes[0],ejes[1],null,"REPETICIONES CON 2 DECIMALES",!0,"Números generados","Repeticiones")}
function midSquare(){var limit=document.getElementById('valor_cant').value||20;var seed1=document.getElementById('valor_seed').value||6897;var zero8=new Padder(8);zero8.pad(seed1);var randoms=[limit];var i;var seed1;var output=[];for(i=0;i<limit;i++){seed1=seed1*seed1;seed1=zero8.pad(seed1);output[i]="N° de 8 digitos: "+seed1+". N° de 4 digitos: "+seed1.substring(2,6);seed1=seed1.substring(2,6);randoms[i]=seed1}
crearTabla(output);var ejes=repetidos(randoms);graficar(ejes[0],ejes[1])}
function Padder(len,pad){if(len===undefined){len=1}else if(pad===undefined){pad='0'}
var pads='';while(pads.length<len){pads+=pad}
this.pad=function(what){var s=what.toString();return pads.substring(0,pads.length-s.length)+s}}
function bbs(){var p=document.getElementById('valor_p').value||5651;var q=document.getElementById('valor_q').value||5623;var limit=document.getElementById('valor_cant').value||20;var randoms=[limit];var M=p*q;var seed=document.getElementById('valor_seed').value||3;if(seed==0){alert("Seed no puede ser 0");return 0}else if(seed==1){alert("Seed no puede ser 1");return 0}else if(gcd(seed,M)!=1){alert("Seed("+seed+") y M("+M+") deben ser coprimos");return 0}else{randoms[0]=seed}
for(var i=1;i<limit;i++){randoms[i]=(randoms[i-1]*randoms[i-1])%M}
crearTabla(randoms);arrayToHistogram(randoms);var ejes=repetidos(randoms);graficar(ejes[0],ejes[1])}
function gcd(a,b){if(!b){return a}
return gcd(b,a%b)}
function bernoulli(){var limit=document.getElementById('valor_cant').value||20;var p=document.getElementById('valor_p').value||0.5;var dec=document.getElementById('valor_dec').value||40;randoms=RNG(limit,dec);brnll=[limit];for(var i=0;i<limit;i++){if(randoms[i]<=p)
brnll[i]=1;else brnll[i]=0};var result=repetidos(brnll);crearTabla(randoms);graficar(result[0],result[1])}
function discretaUniforme(){var limit=document.getElementById('valor_cant').value||2000;var dec=document.getElementById('valor_dec').value||40;var barras=document.getElementById('valor_barras').value||4;randoms=RNG(limit,dec);var max=Math.max.apply(Math,randoms);var min=Math.min.apply(Math,randoms);suma=max-min+(barras-1);crearTabla(randoms);for(var i=0;i<limit;i++){randoms[i]=min+Math.floor(suma*randoms[i])};var result=repetidos(randoms);result=reordenar(result[0],result[1]);graficar(result[0],result[1])}
function poisson(){var limit=document.getElementById('valor_cant').value||1000;var dec=40;var lambda=document.getElementById('valor_lambda').value||2;randoms=RNG(limit,dec);x=[limit];for(var i=0;i<limit;i++){var N=0;var time=1*Math.log(randoms[i])/lambda;while(time<1){N=N+1;var rand=randoms[Math.floor(Math.random()*randoms.length)];time=time+ -1*Math.log(rand)/lambda}
x[i]=N};crearTabla(randoms);arrayToHistogram(x,"Tiempo","Clientes")}
function U5T1P4_binomial(){var n=parseInt(document.getElementById('valor_n').value)||6;var p=parseFloat(document.getElementById('valor_p').value)||0.5;var exacto=parseInt(document.getElementById('valor_x').value)||4;if(exacto>n||exacto<0){alert("x debe estar entre 0 y n");return}
if(p<0||p>=1){alert("p debe estar en el rango [0,1)");return}
var ejeX=[];var pdfarr=[];var cdfarr=[];var temp=p;var j=0;var s=0;var p=0;var t=0;var e=0;for(var i=0;i<=n;i++){if(0==i){s=1;p=1;t=1;for(var k=0;k<n-i;k++)
t=t*(1-temp);}else s=s*((n-i+1)/i);p=p*temp;t=t/(1-temp);j=s*p*t;e=e+j;pdfarr.push(j);cdfarr.push(e)}
console.log(pdfarr);console.log(cdfarr);for(var i=0;i<=n+1;i++){ejeX[i]=i};var pdf={x:ejeX,y:pdfarr,mode:'lines+markers',name:'Ganancia máxima',type:'bar'};var cdf={x:ejeX,y:cdfarr,mode:'lines+markers',name:'Ganancia máxima',type:'bar'};var layoutpdf={title:'Función de densidad de probabilidad',xaxis:{title:'Intentos n'},yaxis:{title:'p(x)'}};var layoutcdf={title:'Función de Distribución Acumulativa',xaxis:{title:'Intentos n'},yaxis:{title:'p(x)'}};var datapdf=[pdf];Plotly.newPlot('graficoPlotly',datapdf,layoutpdf);var datacdf=[cdf]
Plotly.newPlot('graficoPlotly2',datacdf,layoutcdf);var result="Probabilidad de "+exacto+" éxitos en "+n+" intentos es: "+pdfarr[exacto]+". La probabilidad de "+exacto+" o menos exitos es:"+cdfarr[exacto];document.getElementById('res_r2').innerHTML=result}
function binomial2(){var n=document.getElementById('valor_n').value||5;var x=document.getElementById('valor_x').value||2;var p=document.getElementById('valor_p').value||1/6;if(isNaN(n)||isNaN(x)||isNaN(p)){document.getElementById('res_r2').innerHTML="Debe ingresar números";return}
if(p==1){document.getElementById('res_r2').innerHTML="La probabilidad ya es 1";return}
if(n-x<0){document.getElementById('res_r2').innerHTML="Error: Cantidad de éxitos es mayor a intentos";return}
var m1=Math.log(factorialN(parseInt(n)));var m2=Math.log(factorialN(parseInt(x)));var m3=Math.log(factorialN(parseInt(n-x)));var result=Math.exp(m1-m2-m3+x*Math.log(p)+(n-x)*Math.log(1-p));var result2="Probabilidad de "+x+" éxitos en "+n+" intentos es: "+result;document.getElementById('res_r2').innerHTML=result2;console.log("Number of trials: "+n);console.log("Exact number of successes: "+x);console.log("Probability of success: "+p);console.log("Probability of "+x+" successes in "+n+" trials: "+result)}
function geometrica(){var limit=document.getElementById('valor_cant').value||1000;var dec=40;var p=document.getElementById('valor_p').value||0.5;if(p>1){alert("p debe ser menor que 1");return}
randoms=RNG(limit,dec);resultTemp=[limit];for(var i=0;i<limit;i++){resultTemp[i]=Math.floor(Math.log(randoms[i])/Math.log(1-p))};crearTabla(randoms);var result=repetidos(resultTemp);result=reordenar(result[0],result[1]);graficar(result[0],result[1])}
function uniformeContinua(a1,b1,limit1){if(a1!=null){var limit=limit1;var a=a1;var b=b1}
else{var limit=document.getElementById('valor_cant').value||30;var a=document.getElementById('valor_min').value||10;var b=document.getElementById('valor_max').value||20}
var dec=40;a=parseFloat(a);b=parseFloat(b);if(a>b){alert("'b' debe ser mayor que 'a'");return}
randoms=RNG(limit,dec);X=[limit];for(var i=0;i<limit;i++){X[i]=a+(b-a)*randoms[i]};crearTabla(randoms);var result=repetidos(X);result=reordenar(result[0],result[1]);graficar(result[0],result[1]);return result[0]}
function exponencialContinua(){var limit=document.getElementById('valor_cant').value||40;var lambda=parseFloat(document.getElementById('valor_lambda').value)||2.0;var dec=40;randoms=RNG(limit,dec);X=[limit];for(var i=0;i<limit;i++){X[i]=lambda*Math.pow(Math.exp(1),-lambda*randoms[i])};crearTabla(X);for(var i=0;i<limit;i++){X[i]=parseFloat(X[i])};X=Descending(X);graficar(randoms,X,null,"λ",!0,"Número aleatorio","λ")}
function normalContinua(){var limit=document.getElementById('valor_cant').value||1000;var array=[limit];for(var i=0;i<limit;i++){array[i]=randn_bm()};crearTabla(Ascending(array));arrayToHistogram(array)}
function arrayToHistogram(array,titleX,titleY){if(!titleX)
titleX="Números aleatorios";if(!titleY)
titleY="Cantidad";var trace={x:array,type:'histogram',};var layout={bargap:0.03,title:'Histograma',xaxis:{title:titleX},yaxis:{title:titleY}};var data=[trace];Plotly.newPlot('histogram',data,layout)}
function randn_bm(){var u=0,v=0;while(u===0){u=Math.random()}
while(v===0){v=Math.random()}
return Math.sqrt(-2.0*Math.log(u))*Math.cos(2.0*Math.PI*v)}
function factorialN(n){if(n==0){return 1}
return n*factorialN(n-1)}
function reordenar(result0,result1){for(var i=0;i<result0.length;i++){var target=result0[i];var target2=result1[i];for(var j=i-1;j>=0&&(result0[j]>target);j--){result0[j+1]=result0[j];result1[j+1]=result1[j]}
result0[j+1]=target;result1[j+1]=target2}
return[result0,result1]}
function Ascending(numArray){for(var i=0;i<numArray.length;i++){var target=numArray[i];for(var j=i-1;j>=0&&(numArray[j]>target);j--){numArray[j+1]=numArray[j]}
numArray[j+1]=target}
return numArray}
function Descending(numArray){for(var i=0;i<numArray.length;i++){var target=numArray[i];for(var j=i-1;j>=0&&(numArray[j]<target);j--){numArray[j+1]=numArray[j]}
numArray[j+1]=target}
return numArray}
function monteCarloP2(){var limit=document.getElementById('valor_cant').value||1000;var seedZi=parseFloat(document.getElementById('valor_seedZi').value)||500;var precioVenta=parseFloat(document.getElementById('valor_precioVenta').value)||12;var costo=parseFloat(document.getElementById('valor_costo').value)||7.5;var precioDescuento=parseFloat(document.getElementById('valor_precioDescuento').value)||6;var ganancia=0;var cantidadDemandada=0;var randoms=[limit];var tiposGanancias=6;var Q=[[],[],[],[],[],[]];for(var i=0;i<tiposGanancias;i++){for(var j=0;j<limit;j++){Q[i][j]=0}};randoms=RNG(limit,40,seedZi);randoms=normalize_var(randoms,40,90);for(var j=0;j<tiposGanancias;j++){for(var i=0;i<limit;i++){QcantidadOrdenada=40+j*10;Ddemanda=randoms[i];if(Ddemanda>QcantidadOrdenada){ganancia=(precioVenta-costo)*QcantidadOrdenada}
else if(Ddemanda<=QcantidadOrdenada){ganancia=precioVenta*Ddemanda-costo*QcantidadOrdenada+precioDescuento*(QcantidadOrdenada-Ddemanda)}
Q[j][i]=ganancia}}
var promedio=[tiposGanancias];var devStd=[tiposGanancias];var minimo=[tiposGanancias];var maximo=[tiposGanancias];for(var i=0;i<tiposGanancias;i++){promedio[i]=calcularPromedio(Q[i]);devStd[i]=standardDeviation(Q[i]);minimo[i]=arrayMinimo(Q[i]);maximo[i]=arrayMaximo(Q[i])};var promedioTrace={x:[40,50,60,70,80,90],y:promedio,mode:'lines+markers',name:'Ganancia promedio',type:'scatter'};var minimoTrace={x:[40,50,60,70,80,90],y:minimo,mode:'lines+markers',name:'Ganancia mínima',type:'scatter'};var maximoTrace={x:[40,50,60,70,80,90],y:maximo,mode:'lines+markers',name:'Ganancia máxima',type:'scatter'};var layout={title:'Ganancia vs Cantidad pedida',xaxis:{title:'Cantidad pedida'},yaxis:{title:'Ganancia'}};var data=[promedioTrace,minimoTrace,maximoTrace];Plotly.newPlot('graficoPlotly',data,layout);var devStdTrace={x:[40,50,60,70,80,90],y:devStd,mode:'lines+markers',name:'Desviación Standard',type:'scatter'};var layout={title:'DevStandard',xaxis:{title:'Cantidad pedida'},yaxis:{title:'Ganancia'}};var intervaloConfianza=[];for(var i=0;i<tiposGanancias;i++){intervaloConfianza[i]=mctad.confidenceIntervalOnTheMean(promedio[i],devStd[i],limit,0.01);intervaloConfianza[i]=40+i*10+" : "+(intervaloConfianza[i][1]-intervaloConfianza[i][0])/100};crearTabla(intervaloConfianza);var data=[devStdTrace];Plotly.newPlot('graficoPlotly2',data,layout)}
function calcularPromedio(array){var sum,avg=0;if(array.length){sum=array.reduce(function(a,b){return a+b});result=sum/array.length}
return result}
function standardDeviation(values){var avg=calcularPromedio(values);var squareDiffs=values.map(function(value){var diff=value-avg;var sqrDiff=diff*diff;return sqrDiff});var avgSquareDiff=calcularPromedio(squareDiffs);var stdDev=Math.sqrt(avgSquareDiff);return stdDev}
function arrayMinimo(array){var m=Math.min(...array);return m}
function arrayMaximo(array){var m=Math.max(...array);return m}
function normalize_var(array,x,y){var m=Math.min(...array);var range=Math.max(...array)-m;for(var i=0;i<array.length;i++)
array[i]=(array[i]-m)/range;var normalized=[];var range2=y-x;for(i=0;i<array.length;i++){normalized[i]=(array[i]*range2)+x;normalized[i]=Math.round(normalized[i]*0.1)*10}
return normalized}
function U6T1P1_Calcular_PI(){var limit=document.getElementById('valor_cant').value||1000
var randoms=RNG(limit*2,40);var PI=0;var n=limit;var PIarray=[];var p_fuera=0;var p_dentro=0;var xarray=[];var yarray=[];var carray=[];var u,v=0;var x,y=0;var j=0;for(var i=0;i<n;i++){u=randoms[j++];v=randoms[j++];x=2*u-1;y=2*v-1;xarray[i]=x;yarray[i]=y;if((Math.pow(x,2)+Math.pow(y,2))<=1){PI=PI+1;PIarray[i]=PI;carray[i]=1}else{p_fuera=p_fuera+1;carray[i]=0}};for(var i=0;i<n;i++){PIarray[i]=4*PIarray[i]/n};p_fuera=p_fuera/n;p_dentro=PI/n;PI=4*PI/n;var puntosRX=[];var puntosRY=[];var puntosBX=[];var puntosBY=[];for(var i=0;i<n;i++){if(carray[i]>0){puntosBX[i]=xarray[i];puntosBY[i]=yarray[i]}
else{puntosRX[i]=xarray[i];puntosRY[i]=yarray[i]}};PIarray=PIarray.filter(function(n){return!isNaN(n)});crearTabla(PIarray);var puntosB={x:puntosBX,y:puntosBY,mode:'markers',name:'Puntos dentro del círculo',type:'scatter',marker:{color:'blue'}};var puntosR={x:puntosRX,y:puntosRY,mode:'markers',name:'Puntos fuera del círculo',type:'scatter',marker:{color:'red'}};var layout={autosize:!1,width:600,height:500,margin:{l:50,r:50,b:100,t:100,pad:4}};var data=[puntosR,puntosB];Plotly.newPlot('graficoPlotly',data,layout)}
function RNG(limit,decimales,seedZi){if(!seedZi)
var z=seed();else var z=seedZi;var m=Math.pow(2,31);var a=1103515245;var c=12345;var randoms=[limit];randoms[0]=((a*z+c)%m);for(i=1;i<limit;i++){randoms[i]=((a*randoms[i-1]+c)%m)}
for(i=0;i<limit;i++){randoms[i]=randoms[i]/m;randoms[i]=randoms[i].toFixed(decimales)}
return randoms}
